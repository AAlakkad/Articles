# مقدمة في التطوير لـ WordPress

## مقدمة
سنخوض مباشرةً في التطوير، على فرض أن القارئ على اطّلاع بسيط بما يتعّلق بلغة PHP وMySQL ومعلومات عامّة عن كيفية استخدام WordPress.

سنبدأ السلسلة بإنشاء قالبٍ بسيطٍ نتناول من خلاله أساسيات إنشاء القوالب، ثم نَنتقل إلى تطوير الإضافات.

القوالبُ والإضافات متشابهةٌ إلى حدٍٍّ ما، سنوضّح في السلسلة المتشابه والمختلف بينهما، ومتى نستخدم كل نوع.

## متطلبات التشغيل

نحتاج إلى تحميل نسخة WordPress من الموقع الرسمي (http://wordpress.org)، سنستخدم النسخة العربية من هذا الرابط: http://ar.wordpress.org.

تحتاج WordPress إلى خادوم ويب، سواء كان Apache أو Nginx أو الخادوم المدمج مع لغة PHP (بإصدار5.4 وما فوق).

وتحتاج إلى وجود خادوم قواعد بيانات MySQL.

لنقم معاً بإنشاء مجلد جديد هو `wordpress_tutorials` لنضع فيه نسخة WordPress بعد فكّ ضغط الملف الذي قمنا بتنصيبه.
نقوم باستخدام الخادوم المدمج مع PHP لاختصار تنصيب خادوم Apache أو Nginx وتجنب الدخول في الإعدادات الخاصة بكل واحد منهما، لتشغيل الخادوم المدمج نتوجه من سطر اﻷوامر إلى المجلد الذي يحوي نسخة WordPress.
ثم نكتب أمر:
```bash
php -S localhost:8000
```


يتم تشغيل خادوم الويب المدمج مع PHP على الحاسوب، يمكن التوجه عن طريق المتصفح إلى الرابط [localhost:8000](http://localhost:8000) للتأكد من أن الخادوم يعمل.

سنفرض في هذه السلسلة أن خادوم MySQL موجود على الحاسوب بهذا البيانات:

المُضيف: localhost

اسم المسخدم: root

كلمة المرور: root

قاعدة البيانات: wordpress_tutorials


**ملاحظة:** يمكن أن تستخدم البرامج المجهزة لتطوير الويب مثل MAMP، WAMP أو XAMPP. مع مراعاة الاختلاف بين رابط خادوم الويب ومعلومات خادوم MySQL مع ما سنستخدمه في هذه السلسلة.

في أول مرة نتوجه من المتصفح إلى رابط الخادوم المدمج، تظهر لنا صفحة تنصيب WordPress
![صفحة تنصيب WordPress](https://i.imgur.com/80CZomE.png)

نقوم بملء بيانات خادوم MySQL أثناء عملية التنصيب

![ملء بيانات خادوم MySQL](https://i.imgur.com/5xuZxzS.png)

تقوم WordPress بفحص الاتصال مع خادوم MySQL وتظهر رسالة توضّح نجاح العملية

![نجاح عملية الاتصال مع خادوم MySQL](https://i.imgur.com/M5dNl07.png)

ونحتاج أيضاً إلى إدخال المعلومات العامة مثل اسم المدونة والبريد الإلكتروني للمستخدم. 

![enter image description here](https://i.imgur.com/aJYtlch.png "إدخال معلومات المدونة")

بعد الانتهاء من عملية تنصيب WordPress نكون جاهزين للبدء بتطوير قالبنا الأول.

![انتهاء عملية التنصيب](https://i.imgur.com/MzJ61Ce.png)


## تطوير القوالب

### مقدمة

سنقوم بالاعتماد على تصميم قمتُ بإعداده مسبقاً من أجل هذه السلسلة، التصميم هو قالب عادي، يحوي بضع ملفات HTML و CSS و JavaScript. وهو مبني على إطار عمل Foundation مع بعض التعديلات.

نتوجه إلى مجلد المشروع الذي يحوي ملفات WordPress، منه نتوجه إلى مجلد `wp-content` ثم مجلد `themes`. نقوم بإنشاء مجلد اسمه `my_theme` بمثابة مجلد القالب الذي سنقوم بإنشاءه.

### ملفات القالب الأساسية

نحتاج إلى وجود ملفين على الأقل ضمن مجلد القالب الذي أنشأناه، هما:
- `style.css`
- `index.php`
 
وهذا أقل ما يجب وجوده في القالب ليكون قالباً صالحاً للعمل.

نتجه إلى صفحة تغيير القوالب من لوحة تحكم WordPress لنرى ما يشبه:

***صور لصفحة القوالب***

كما تلاحظون لا نرى القالب الجديد الذي أنشأناه ضمن القوالب، وذلك ﻷن هناك شئياً آخيراً علينا فعله قبل أن نرى القالب الجديد في هذه الصفحة.

نحتاج إلى وضع تعليق في ملف `style.css` كالتالي (يمكن تعديل أي قيمة أيضاً):
```css
/*
Theme Name: قالبي الجديد
Author: عمار العقاد
Author URI: http://aalakkad.me
Description: قالب جديد، نقوم من خلاله بالتدرب على إنشاء قوالب WordPress.
Version: 1.0
*/
```
تقوم WordPress بالدخول إلى كل مجلد في مجلد القوالب، ثم تبحث عن ملف `style.css` بداخله تعليق يشبه التعليق السابق، ثم تقوم بتفسير هذه التعليقات ووضعها في صفحة القوالب التي يرى المستخدم من خلالها أسماء وتوصيف القوالب. وهناك تفصيلات أخرى للتعليقات في `style.css` لن نخوض فيها الآن.

يمكن التوجه إلى صفحة القوالب من خلال لوحة التحكم، لنرى شيئاً مشابهاً لما يلي:

***صورة من صفحة القوالب بعد إضافة القالب***

لنقم بتفعيل هذا القالب الجديد، ثم نتوجه إلى الصفحة الرئيسية للمدونة (الصفحة التي تُظهر المقالات وليست صفحة لوحة التحكم).
سنرى صفحة بيضاء دون أن تحوي أي شيء، وذلك ﻷن القالب ما زال فارغاً تماماً.
لا تقلقوا سنقوم بملئه في تتمه السلسلة، لن يبقى كهذا :)

### نقل قالب HTML إلى قالب WordPress

سنقوم كخطوةٍ أولى أن نضع قالب HTML في ملف `index.php` ونقوم بتعديل مسارات ملفات CSS و JavaScript.


ستكون جميع الصفحات التي نستخدمها من WordPress بعد تفعيل القالب الجديد متطابقة، وكأنها قالب HTML نفسه. وهذا هو المطلوب في هذه المرحلة، سنقوم بإضافة التفاصيل فيما بعد وعلى عدة مراحل.

نقوم الآن بنسخ محتوى ملف `index.html` كاملاً من قالب HTML ونضعه في ملف `index.php` في قالبنا الجديد `my_theme` ضمن WordPress.
ثم ننسخ مجلد `assets` كما هو إلى داخل مجلد قالبنا الجديد.

لنرى كيف أصبح شكل الموقع بعد أن وضعنا محتوى القالب في ملف `index.html`:

***صورة من للقالب بدون ستايل***

لا تقلقوا، يظهر القالب بهذا الشكل ﻷن ملفات CSS وJavaScript أصبحت في مسار مختلف عن المسار الذي كان موجوداً في قالب HTML.

علينا الآن أن نقوم بتعديل مسارات هذه الملفات كي يصبح شكل قالب WordPress الجديد مطابقاً لشكل قالب HTML.

توفر لنا WordPress عدداً من الدّوالّ (functions) مهمتها تسهيل إنشاء القوالب، سنستخدم منها `get_template_directory_uri()`، تقوم هذه الدالّة بإرجاع قيمة نصّيّة هي رابط القالب.

مثلاً، إن كان مجلد القالب هو `my_theme` ورابط خادوم الويب الذي نعمل عليه هو `http://localhost:8000` ستكون نتيجة الدالّة هي:

> http://localhost:8000/wp-content/my_theme

يجب أن نستخدم هذه الدالّة أو ما يشابهها لنحصل على الروابط، ولا نستخدمُ روابط نضعها بشكل يدوي، فرابط خادوم الويب يمكن أن يتغير، وإن كانت الروابط موضوعةً بشكل يدوي سيظهر شكل القالب كما في الأعلى خالياً من ملفات CSS و JavaScript.

نقوم بتعديل ملف index.html في قسم head، نبحث عن سطر استدعاء ملفات CSS، ثم نقوم بالتعديل عليها لتصبح بالشكل:

```html
<link rel="stylesheet" href="<?php echo get_template_directory_uri();?>/assets/css/main.css">
```

في قسم head أيضاً نريد استبدال رابط استدعاء ملف `modernizr.js` ليستخدم دالّة `get_template_directory()`، فيصبح:

```html
<script src="<?php echo get_template_directory_uri(); ?>/assets/js/vendor/modernizr.js"></script>
```

أخيراً نبحث في نهاية ملف `index.php` عن سطر استدعاء ملف JavaScript، ونقوم بالتعديل عليه ليصبح كما يلي:

```html
<script src="<?php echo get_template_directory_uri(); ?>/assets/js/vendor.js"></script>
```

الآن عندما يتم طلب المدونة من المتصفح، ستكون النتيجة النهائية للتعديلات الثلاثة التي قمنها بها كالتالي:
```html
<link rel="stylesheet" href="http://localhost:8000/wp-content/themes/my_theme/assets/css/main.css">

<script src="http://localhost:8000/wp-content/themes/my_theme/assets/js/vendor/modernizr.js"></script>

<script src="http://localhost:8000/wp-content/themes/my_theme/assets/js/vendor.js"></script>
```

نذهب الآن إلى الصفحة الرئيسية للمدونة لنرى كيف أصبح القالب.

***صورة للقالب بعد تطبيق الستايل***

في الدرس القادم من السلسلة سنتعرف إلى كيفية جلب المواضيع من قاعدة البيانات وعرضها في الصفحة الرئيسية بدلاً من المواضيع الشكليّة التي نراها في قالب HTML.