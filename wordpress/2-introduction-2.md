[TOC]
# مقدمة في تطوير قوالب ووردبريس - الجزء الثاني

تعرفنا في الدرس الماضي على كيفية البدء بتحويل قالب HTML إلى قالب ووردبريس (WordPress) ورأينا كيف يتم استخدام التسلسل الهرمي لملفات القالب، ثم أضفنا عليه بعض الوسوم لإظهار المقالات من قاعدة البيانات.

في هذا الدرس سنقوم بإظهار أرقام الصفحات في الصفحة الرئيسية عندما يكون عدد المقالات في المدونة أكبر من عدد المقالات التي يتم إظهارها في الصفحة الرئيسية.

وسنقوم بالتعرف على كيفية استخدام أجزاء القالب (Template Parts) لإظهار أرقام الصفحات في الصفحة الرئيسية (index.php) أو في غيرها إن دعت الحاجة.

## استخدام أجزاء القالب (Template Parts)

أجزاء القالب من الأمور الهامة أثناء تطوير قوالب ووردبريس، تأتي أهميتها في الحثّ على عدم التكرار وإعادة الاستخدام.
فمثلاً تحتاجُ في القالب لوضع أزرار المشاركة في عدد من الأماكن، فبدلاً من أن يتم النسخ واللصق لاستعمال الأزرار في عدد من الأمكنة، يتم استخدام أجزاء القالب، ثم استدعاء الجزء المطلوب بجملة واحدة.
بهذا نقلل من حجم الكود، ونختصر من الوقت المطلوب لإجراء التعديل على هذه الأجزاء، وبالتالي نقلل من الأخطاء المحتملة قدر الإمكان.

استخدام أجزاء القالب بسيط، يتألف من قسمين:
- القسم الأول هو كيفية تسمية الملفات (الأجزاء) بطريقة تسمح للدّالّة بإيجاد الملف.
- القسم الثاني هو استخدام الدّالّة لاستدعاء الملف المطلوب ضمن وسوم الصفحة.

### استخدام دالّة استدعاء الملف

نقوم باستخدام دالة [`get_template_part()`](http://codex.wordpress.org/Function_Reference/get_template_part) لطلب الملف الذي نريده، نمرر للدّالة اسم الملف المطلوب بالطريقة التالي:
```php
<?php
get_template_part('sharing');
?>
```
في هذه الحالة يكون اسم الملف: `sharing.php` موجود بجوار ملف `index.php` وباقي ملفات القالب.

تعمل الدّالة بشكل مشابه لدالّة [`include`](http://php.net/manual/en/function.include.php) الشهيرة ضمن لغة PHP.

فلو وضعنا ضمن ملف `sharing.php` أي محتوى سواء كان وسوم HTML أو PHP فإنه سيتم عرضه أو تنفيذه في المكان الذي استخدمنا فيه دالّة `get_template_part`.

### طريقة تسمية أجزاء القالب

سنعرض بضعة أمثلة نستشكف من خلالها كيفية وضع أسماء الملفات مع كيفية استدعاءها عن طريق الدّالّة:

اسم الملف: `pagination.php`
طريقة الاستدعاء: `<?php get_template_part('pagination');?>`

اسم الملف: `pagination.php` داخل مجلد `parts`
طريقة الاستدعاء: `<?php get_template_part('parts/pagination');?>`

اسم الملف: `pagination-posts.php`
طريقة الاستدعاء: `<?php get_template_part('pagination', 'posts');?>`

اسم الملف: `pagination-posts.php` داخل مجلد `parts`
طريقة الاستدعاء: `<?php get_template_part('parts/pagination', 'parts');?>`

#### تسمية الملفات وتمرير المحددات
- نقوم بتمرير اسم الملف إلى الدّالّة بدون لاحقة الملف `.php`.
- المحدّد الثاني للدّالّة هو الجزء الثاني من اسم الملف، الجزء الذي يأتي بعد إشارة `-`.
- في حال كان الملف داخل مجلد، نقوم بوضع المسار قبل اسم الملف.



## إضافة مقالات متنوعة لتجربة القالب

سنقوم باستخدام [الملف](https://wpcom-themes.svn.automattic.com/demo/theme-unit-test-data.xml) المقدم [لمطوّري ووردبريس](http://codex.wordpress.org/Theme_Unit_Test) الذي يحوي مقالات "شكليّة" متنوعة، هدفها رؤية شكل القالب بوجود عدة أشكال من المقالات.

- بعد تنصيب الملف، نتوجه من لوحة التحكم إلى "أدوات" ثم "استيراد"، بعد ذلك نختار "WordPress" فتظهر لنا نافذة تنصيب إضافة الاستيراد.
- نقوم بتفعيل الإضافة التي قمنا بتنصيبها.
- تظهر لنا صفحة الإضافة لاستيراد ملف `xml` الذي قمنا بتحميله منذ قليل.
- نختار الملف، ثم نضغط زر "ارفع الملف واستورده"
- تظهر لنا صفحة فيها عدد من الخيارات لإنشاء مستخدمين جدد وفي آخرها خيار " Download and import file attachments"، يمكن أن نترك حقول المستخدمين فارغة. لكن نضغط الخيار السابق لتحميل الصور الخاصة بالمقالات.
- نضغط زر submit وننتظر قليلاً ريثما يتم استيراد المقالات وتحميل الصور.


## إضافة أرقام الصفحات **
يوجد عدة طرق لعرض أرقام الصفحات بطريقة تناسب شكل القالب الذي نقوم باستخدامه (تناسب كيفية عمل أرقام الصفحات في إطاري عمل [Bootstrap](http://getbootstrap.com) و [Foundation](http://foundation.zurb.com/)).

- إما نقوم بنسخ دّالّة [`paginate_links()`](http://codex.wordpress.org/Function_Reference/paginate_links) المسؤولة عن عرض أرقام الصفحات ونعدّل عليها حسب المطلوب، وذلك في ملف `functions.php` داخل ملفات قالب ووردبريس.
- أو نقوم بإنشاء دالّة جديدة تحاكي مبدأ عمل دالّة `paginate_links()` لكن بخيارات أقل حسب ما يتطلبه القالب.
- أو نقوم باستخدام إضافة [WP-PageNavi](https://wordpress.org/plugins/wp-pagenavi/) التي تعمل بطريقة مشابهة لدالّة `paginate_links()` لكن مع المزيد من الخيارات، منها إمكانية التحكم بالوسوم عن طريق ما يسمّى [Filters](http://codex.wordpress.org/Plugin_API/Filter_Reference).

سنقوم باستخدام الطريقة الأولى، ويمكن استخدام الطريقة الأخيرة في وقت لاحق عندما نتحدث عن Actions/Filters.




## إمكانية ارفاق صورة لكل مقال **
ربما لاحظت أثناء إضافة المقالات أنه لا يوجد مكان لإضافة الصورة المميزة (featured image)، وهذا صحيح، فمن أجل إظهار الصورة 
```php
<?php
add_theme_support('thumbnail');
```

### حجم الصور المميزة **
عند عرض الصورة المميزة في الشريط الجانبي، لا ينبغي أن نعرض الصورة بحجمها الطبيعي، فلو كانت الصورة بأبعاد 800\*600 فلا ينبغي تصغيرها عن طريق وسوم HTML أو خصائص CSS من أجل جعل مقاسها 80\*60 مثلاً ليتم عرضها في الشريط الجانبي.

توفّر ووردبريس للمطوّرين 3 أحجام جاهزة لكل صورة مميزة، يتم إنشاء هذه الحجوم بشكل تلقائي دون أي تدخّل برمجيّ من المطوّر.


### إضافة حجوم مخصصة للصورة المميزة **

ماذا لو لم تتناسب الحجوم الجاهزة للصور المميزة مع القالب الذي نقوم بإنشاءه؟
تقدّم ووردبريس خياراً لإضافة حجوم مخصصة للصور المميزة، فيتمكّن المطور من إضافة الحجم الأنسب للقالب الذي يقوم بصنعه. ليعرض الصورة دون أي تصغير أو تكبير لها عن طريق HTML أو CSS.

## إضافة القائمة الرئيسية **

يمكن إضافة العناصر للقائمة عن طريق لوحة التحكم ثم المظهر ثم القوائم.

## التعليقات **
### تجهيز صفحة المقال single.php
### إضافة ملف التعليقات

